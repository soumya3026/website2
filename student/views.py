from django.shortcuts import render
from .models import basic_3_1
from .models import mid1_3_1
from .models import mid2_3_1
from .models import external_3_1,student_profile,counselling_3_1,problems_3_1,cstatus_3_1,student_edu,student_adm,student_parent,student_stay,student_extra,student_profile
from .models import *
from accounts.models import MyUser
from django.contrib import messages
from django.forms.models import model_to_dict
from django.apps import apps

global year
global semester

# Create your views here.
def change(request):
    if request.method=="POST":
        old=request.POST.get("old")
        new=request.POST.get("new")
        rnew=request.POST.get("rnew")
        a=MyUser.objects.get(username=request.user.username)
        if a.check_password(old):
            if new==rnew:
                a.set_password(new)
                a.save()
                messages.info(request,'password has been updated succefully!!!')
            else:
                messages.info(request,'please re-enter the password carefully!!!')
        else:
            messages.info(request,'please enter correct password!!!')
    return render(request,'counselling/change.html')

def form(request):
    p=student_profile.objects.get(uname=request.user.username)
    b111=basic_1_1.objects.get(uname=request.user.username)
    b211=mid1_1_1.objects.get(uname=request.user.username)
    b311=mid2_1_1.objects.get(uname=request.user.username)
    b411=external_1_1.objects.get(uname=request.user.username)
    b511=counselling_1_1.objects.get(uname=request.user.username)
    b611=problems_1_1.objects.get(uname=request.user.username)
    b112=basic_1_2.objects.get(uname=request.user.username)
    b212=mid1_1_2.objects.get(uname=request.user.username)
    b312=mid2_1_2.objects.get(uname=request.user.username)
    b412=external_1_2.objects.get(uname=request.user.username)
    b512=counselling_1_2.objects.get(uname=request.user.username)
    b612=problems_1_2.objects.get(uname=request.user.username)
    b121=basic_2_1.objects.get(uname=request.user.username)
    b221=mid1_2_1.objects.get(uname=request.user.username)
    b321=mid2_2_1.objects.get(uname=request.user.username)
    b421=external_2_1.objects.get(uname=request.user.username)
    b521=counselling_2_1.objects.get(uname=request.user.username)
    b621=problems_2_1.objects.get(uname=request.user.username)
    b122=basic_2_2.objects.get(uname=request.user.username)
    b222=mid1_2_2.objects.get(uname=request.user.username)
    b322=mid2_2_2.objects.get(uname=request.user.username)
    b422=external_2_2.objects.get(uname=request.user.username)
    b522=counselling_2_2.objects.get(uname=request.user.username)
    b622=problems_2_2.objects.get(uname=request.user.username)
    b131=basic_3_1.objects.get(uname=request.user.username)
    b231=mid1_3_1.objects.get(uname=request.user.username)
    b331=mid2_3_1.objects.get(uname=request.user.username)
    b431=external_3_1.objects.get(uname=request.user.username)
    b531=counselling_3_1.objects.get(uname=request.user.username)
    b631=problems_3_1.objects.get(uname=request.user.username)
    b132=basic_3_2.objects.get(uname=request.user.username)
    b232=mid1_3_2.objects.get(uname=request.user.username)
    b332=mid2_3_2.objects.get(uname=request.user.username)
    b432=external_3_2.objects.get(uname=request.user.username)
    b532=counselling_3_2.objects.get(uname=request.user.username)
    b632=problems_3_2.objects.get(uname=request.user.username)
    b141=basic_4_1.objects.get(uname=request.user.username)
    b241=mid1_4_1.objects.get(uname=request.user.username)
    b341=mid2_4_1.objects.get(uname=request.user.username)
    b441=external_4_1.objects.get(uname=request.user.username)
    b541=counselling_4_1.objects.get(uname=request.user.username)
    b641=problems_4_1.objects.get(uname=request.user.username)
    b142=basic_4_2.objects.get(uname=request.user.username)
    b242=mid1_4_2.objects.get(uname=request.user.username)
    b342=mid2_4_2.objects.get(uname=request.user.username)
    b442=external_4_2.objects.get(uname=request.user.username)
    b542=counselling_4_2.objects.get(uname=request.user.username)
    b642=problems_4_2.objects.get(uname=request.user.username)
    s=student_profile.objects.get(uname=request.user.username)
    b='basic_'+s.year+'_'+s.sem
    model1= apps.get_model('student', b)
    j=model1.objects.get(uname=request.user.username)
    s=MyUser.objects.get(username=j.counsellor_name)
    sample={"s":s,"b111":b111,"b211":b211,"b311":b311,'b411':b411,'b511':b511,'b611':b611,"b112":b112,"b212":b212,"b312":b312,'b412':b412,'b512':b512,'b612':b612,
            "b121":b121,"b221":b221,"b321":b321,'b421':b421,'b521':b521,'b621':b621,"b122":b122,"b222":b222,"b322":b322,'b422':b422,'b522':b522,'b622':b622,
            "b121":b131,"b231":b231,"b331":b331,'b431':b431,'b531':b531,'b631':b631,"b132":b132,"b232":b232,"b332":b332,'b432':b432,'b532':b532,'b632':b632,
            "b141":b141,"b241":b241,"b341":b341,'b441':b441,'b541':b541,'b641':b641,"b142":b142,"b242":b242,"b342":b342,'b442':b442,'b542':b542,'b642':b642,'p':p}
    return render(request,'counselling/form.html',sample)

def fill(request):
    b=basic_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_1_1(uname=request.user.username)
        b1.save()
    b=mid1_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_1_1(uname=request.user.username)
        b1.save()
    b=mid2_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_1_1(uname=request.user.username)
        b1.save()
    b=external_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_1_1(uname=request.user.username)
        b1.save()
    b=counselling_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_1_1(uname=request.user.username)
        b1.save()
    b=problems_1_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_1_1(uname=request.user.username)
        b1.save()
    b=cstatus_1_1.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_1_1(uname=request.user.username)
        b1.save()
    b=basic_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_1_2(uname=request.user.username)
        b1.save()
    b=mid1_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_1_2(uname=request.user.username)
        b1.save()
    b=mid2_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_1_2(uname=request.user.username)
        b1.save()
    b=external_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_1_2(uname=request.user.username)
        b1.save()
    b=counselling_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_1_2(uname=request.user.username)
        b1.save()
    b=problems_1_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_1_2(uname=request.user.username)
        b1.save()
    b=cstatus_1_2.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_1_2(uname=request.user.username)
        b1.save()
    b=basic_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_2_1(uname=request.user.username)
        b1.save()
    b=mid1_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_2_1(uname=request.user.username)
        b1.save()
    b=mid2_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_2_1(uname=request.user.username)
        b1.save()
    b=external_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_2_1(uname=request.user.username)
        b1.save()
    b=counselling_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_2_1(uname=request.user.username)
        b1.save()
    b=problems_2_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_2_1(uname=request.user.username)
        b1.save()
    b=cstatus_2_1.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_2_1(uname=request.user.username)
        b1.save()
    b=basic_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_2_2(uname=request.user.username)
        b1.save()
    b=mid1_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_2_2(uname=request.user.username)
        b1.save()
    b=mid2_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_2_2(uname=request.user.username)
        b1.save()
    b=external_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_2_2(uname=request.user.username)
        b1.save()
    b=counselling_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_2_2(uname=request.user.username)
        b1.save()
    b=problems_2_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_2_2(uname=request.user.username)
        b1.save()
    b=cstatus_2_2.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_2_2(uname=request.user.username)
        b1.save()
    b=basic_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_3_1(uname=request.user.username)
        b1.save()
    b=mid1_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_3_1(uname=request.user.username)
        b1.save()
    b=mid2_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_3_1(uname=request.user.username)
        b1.save()
    b=external_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_3_1(uname=request.user.username)
        b1.save()
    b=counselling_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_3_1(uname=request.user.username)
        b1.save()
    b=problems_3_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_3_1(uname=request.user.username)
        b1.save()
    b=cstatus_3_1.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_3_1(uname=request.user.username)
        b1.save()
    b=basic_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_3_2(uname=request.user.username)
        b1.save()
    b=mid1_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_3_2(uname=request.user.username)
        b1.save()
    b=mid2_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_3_2(uname=request.user.username)
        b1.save()
    b=external_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_3_2(uname=request.user.username)
        b1.save()
    b=counselling_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_3_2(uname=request.user.username)
        b1.save()
    b=problems_3_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_3_2(uname=request.user.username)
        b1.save()
    b=cstatus_3_2.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_3_2(uname=request.user.username)
        b1.save()
    b=basic_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_4_1(uname=request.user.username)
        b1.save()
    b=mid1_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_4_1(uname=request.user.username)
        b1.save()
    b=mid2_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_4_1(uname=request.user.username)
        b1.save()
    b=external_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_4_1(uname=request.user.username)
        b1.save()
    b=counselling_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_4_1(uname=request.user.username)
        b1.save()
    b=problems_4_1.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_4_1(uname=request.user.username)
        b1.save()
    b=cstatus_4_1.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_4_1(uname=request.user.username)
        b1.save()
    b=basic_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=basic_4_2(uname=request.user.username)
        b1.save()
    b=mid1_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid1_4_2(uname=request.user.username)
        b1.save()
    b=mid2_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=mid2_4_2(uname=request.user.username)
        b1.save()
    b=external_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=external_4_2(uname=request.user.username)
        b1.save()
    b=counselling_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=counselling_4_2(uname=request.user.username)
        b1.save()
    b=problems_4_2.objects.filter(uname=request.user.username).exists()
    if(b==False):
        b1=problems_4_2(uname=request.user.username)
        b1.save()
    b=cstatus_4_2.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=cstatus_4_2(uname=request.user.username)
        b1.save()
    b=student_edu.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_edu(uname=request.user.username)
        b1.save()
    b=student_edu.objects.get(uname=request.user.username)
    b=student_adm.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_adm(uname=request.user.username)
        b1.save()
    b=student_adm.objects.get(uname=request.user.username)
    b=student_extra.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_extra(uname=request.user.username)
        b1.save()
    b=student_extra.objects.get(uname=request.user.username)
    b=student_parent.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_parent(uname=request.user.username)
        b1.save()
    b=student_parent.objects.get(uname=request.user.username)
    b=student_stay.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_stay(uname=request.user.username)
        b1.save()
    b=student_stay.objects.get(uname=request.user.username)
    b=student_profile.objects.filter(uname=request.user.username).exists() 
    if(b==False):
        b1=student_profile(uname=request.user.username)
        b1.save()
    p1=student_profile.objects.get(uname=request.user.username)
    if p1.done=='0':
        return render(request,'counselling/profile.html',{'p1':p1})
    else:
        s=student_profile.objects.get(uname=request.user.username)
        ye=s.year
        se=s.sem
        a='cstatus_'+ye+'_'+se
        model1 = apps.get_model('student', a)
        b=model1.objects.get(uname=request.user.username)
        if request.method=="POST":
            year=request.POST.get("year",False)
            semester=request.POST.get("sem",False)
            request.session['year'] = year
            request.session['semester'] = semester
            year=request.session.get('year')
            semester=request.session.get('semester')
            return render(request,'counselling/fill2.html',{"b":b,'y':ye,'s':se})
        else:
            return render(request,'counselling/fill.html',{'b':b,'y':ye,'s':se})

def fill2(request):
    s=student_profile.objects.get(uname=request.user.username)
    ye=s.year
    se=s.sem
    a='cstatus_'+ye+'_'+se
    model1 = apps.get_model('student', a)
    b=model1.objects.get(uname=request.user.username)
    if request.method=="POST":
        year=request.POST.get("year",False)
        semester=request.POST.get("sem",False)
        request.session['year'] = year
        request.session['semester'] = semester
        return render(request,'counselling/fill2.html',{"b":b,'y':ye,'s':se})
    else:
        return render(request,'counselling/fill2.html',{'b':b,'y':ye,'s':se})


def counseling(request):
    s=student_profile.objects.get(uname=request.user.username)
    year=s.year
    semester=s.sem
    h='problems_'+year+'_'+semester
    model = apps.get_model('student', h)
    b2=model.objects.filter(uname=request.user.username).exists()
    if(b2==False):
        b=model(uname=request.user.username)
        b.save()
    if request.method=="POST":
        c1_general=request.POST.get("gprob1",'')
        c1_studies=request.POST.get("sprob1",'')
        c1_health=request.POST.get("hprob1",'')
        c2_general=request.POST.get("gprob2",'')
        c2_studies=request.POST.get("sprob2",'')
        c2_health=request.POST.get("hprob2",'')
        c3_general=request.POST.get("gprob3",'')
        c3_studies=request.POST.get("sprob3",'')
        c3_health=request.POST.get("hprob3",'')
        c4_general=request.POST.get("gprob4",'')
        c4_studies=request.POST.get("sprob4",'')
        c4_health=request.POST.get("hprob4",'')
        c5_general=request.POST.get("gprob5",'')
        c5_studies=request.POST.get("sprob5",'')
        c5_health=request.POST.get("hprob5",'')
        b2=model.objects.filter(uname=request.user.username).exists()
        if(b2==False):
            b=model(uname=request.user.username,c1_general=c1_general,c1_studies=c1_studies,c1_health=c1_health,c2_general=c2_general,c2_studies=c2_studies,c2_health=c2_health,c3_general=c3_general,c3_studies=c3_studies,c3_health=c3_health,c4_general=c4_general,c4_studies=c4_studies,c4_health=c4_health,c5_general=c5_general,c5_studies=c5_studies,c5_health=c5_health)
            b.save()
        else:
            b3=model.objects.get(uname=request.user.username)
            c1_general=request.POST.get("gprob1",b3.c1_general)
            c1_studies=request.POST.get("sprob1",b3.c1_studies)
            c1_health=request.POST.get("hprob1",b3.c1_health)
            c2_general=request.POST.get("gprob2",b3.c2_general)
            c2_studies=request.POST.get("sprob2",b3.c2_studies)
            c2_health=request.POST.get("hprob2",b3.c2_health)
            c3_general=request.POST.get("gprob3",b3.c3_general)
            c3_studies=request.POST.get("sprob3",b3.c3_studies)
            c3_health=request.POST.get("hprob3",b3.c3_health)
            c4_general=request.POST.get("gprob4",b3.c4_general)
            c4_studies=request.POST.get("sprob4",b3.c4_studies)
            c4_health=request.POST.get("hprob4",b3.c4_health)
            c5_general=request.POST.get("gprob5",b3.c5_general)
            c5_studies=request.POST.get("sprob5",b3.c5_studies)
            c5_health=request.POST.get("hprob5",b3.c5_health)
            model.objects.filter(uname=request.user.username).update(c1_general=c1_general,c1_studies=c1_studies,c1_health=c1_health,c2_general=c2_general,c2_studies=c2_studies,c2_health=c2_health,c3_general=c3_general,c3_studies=c3_studies,c3_health=c3_health,c4_general=c4_general,c4_studies=c4_studies,c4_health=c4_health,c5_general=c5_general,c5_studies=c5_studies,c5_health=c5_health)
    h='counselling_'+year+'_'+semester
    model1= apps.get_model('student', h)
    b5=model1.objects.get(uname=request.user.username)
    b6=model.objects.get(uname=request.user.username)
    h='cstatus_'+year+'_'+semester
    model2= apps.get_model('student', h)
    b7=model2.objects.get(uname=request.user.username)
    return render(request,'counselling/counseling.html',{"b5":b5,"b6":b6,"b7":b7,"y":year,"s":semester})

def profile(request):
    if request.method=="POST":
        p1=student_profile.objects.get(uname=request.user.username)
        student_profile.objects.filter(uname=request.user.username).update(done=1)
        roll_no=request.POST.get("rno",'')

        basic_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        mid1_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        mid2_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        external_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        counselling_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        cstatus_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)
        problems_3_1.objects.filter(uname=request.user.username).update(roll_no=roll_no)

        name=request.POST.get("name",'')
        branch=request.POST.get("branch",'')
        section=request.POST.get("section",'')
        year=request.POST.get("year",'')
        sem=request.POST.get("sem",'')
        DOB=request.POST.get("dob",p1.DOB)
        aadhar=request.POST.get("adaar")
        mobile=request.POST.get("ph_no")
        email=request.POST.get("email",'')
        sec_per=request.POST.get("percentage",'')
        sec_grade=request.POST.get("grade",'')
        sec_scl=request.POST.get("school",'')
        inter_per=request.POST.get("ipercenatge",'')
        inter_grade=request.POST.get("igrade",'')
        inter_scl=request.POST.get("ischool",'')
        eamcet_htno=request.POST.get("htno",'')
        eamcet_rank=request.POST.get("rank",'')
        eamcet_yr=request.POST.get("year",'')
        jee_htno=request.POST.get("jhtno",'')
        jee_rank=request.POST.get("jrank",'')
        jee_yr=request.POST.get("jyear",'')
        ecet_htno=request.POST.get("ehtno",'')
        ecet_rank=request.POST.get("erank",'')
        ecet_yr=request.POST.get("eyear",'')
        nationality=request.POST.get("nationality",'')
        religion=request.POST.get("religion",'')
        state=request.POST.get("state",'')
        caste=request.POST.get("caste",'')
        cat_admission=request.POST.get("cat",'')
        fee_reimb=request.POST.get("fee",'')
        f_name=request.POST.get("fname",'')
        f_qual=request.POST.get("fqual",'')
        f_occup=request.POST.get("foccup",'')
        f_email=request.POST.get("femail",'')
        f_mobile=request.POST.get("fmobile",'')
        f_income=request.POST.get("fincome",'')
        m_name=request.POST.get("mname",'')
        m_qual=request.POST.get("mqual",'')
        m_occup=request.POST.get("moccup",'')
        m_email=request.POST.get("memail",'')
        m_mobile=request.POST.get("mmobile",'')
        m_income=request.POST.get("mincome",'')
        p_address=request.POST.get("paddress",'')
        c_address=request.POST.get("caddress",'')
        stay=request.POST.get("hd",'')
        h_name=request.POST.get("hname",'')
        h_phno=request.POST.get("hph_no",'')
        h_address=request.POST.get("haddress",'')
        g_name=request.POST.get("gname",'')
        g_phno=request.POST.get("gph_no",'')
        g_address=request.POST.get("gaddress",'')
        blood_gr=request.POST.get("bgroup",'')
        eye=request.POST.get("eye",'')
        height=request.POST.get("height",'')
        weight=request.POST.get("weight",'')
        illness=request.POST.get("illness",'')
        medicine=request.POST.get("medicine",'')
        academic_ach=request.POST.get("academics",'')
        extra_ach=request.POST.get("activities",'')
        e=student_extra.objects.filter(uname=request.user.username).exists()
        if(e==False):
            e=student_extra(uname=request.user.username,roll_no=roll_no,blood_gr=blood_gr,eye=eye,height=height,weight=weight,illness=illness,medicine=medicine,academic_ach=academic_ach,extra_ach=extra_ach)
            e.save()
        else:
            student_extra.objects.filter(uname=request.user.username).update(roll_no=roll_no,blood_gr=blood_gr,eye=eye,height=height,weight=weight,illness=illness,medicine=medicine,academic_ach=academic_ach,extra_ach=extra_ach)
        s=student_stay.objects.filter(uname=request.user.username).exists()
        if(s==False):
            s=student_stay(uname=request.user.username,roll_no=roll_no,stay=stay,h_name=h_name,h_phno=h_phno,h_address=h_address,g_name=g_name,g_phno=g_phno,g_address=g_address)
            s.save()
        else:
            student_stay.objects.filter(uname=request.user.username).update(roll_no=roll_no,stay=stay,h_name=h_name,h_phno=h_phno,h_address=h_address,g_name=g_name,g_phno=g_phno,g_address=g_address)
        pa=student_parent.objects.filter(uname=request.user.username).exists()
        if(pa==False):
            pa=student_parent(uname=request.user.username,roll_no=roll_no,f_name=f_name,f_qual=f_qual,f_occup=f_occup,f_email=f_email,f_mobile=f_mobile,f_income=f_income,m_name=m_name,m_qual=m_qual,m_occup=m_occup,m_email=m_email,m_mobile=m_mobile,m_income=m_income,p_address=p_address,c_address=c_address)
            pa.save()
        else:
            student_parent.objects.filter(uname=request.user.username).update(roll_no=roll_no,f_name=f_name,f_qual=f_qual,f_occup=f_occup,f_email=f_email,f_mobile=f_mobile,f_income=f_income,m_name=m_name,m_qual=m_qual,m_occup=m_occup,m_email=m_email,m_mobile=m_mobile,m_income=m_income,p_address=p_address,c_address=c_address)
        a=student_adm.objects.filter(uname=request.user.username).exists()
        if(a==False):
            a=student_adm(uname=request.user.username,roll_no=roll_no,nationality=nationality,religion=religion,state=state,caste=caste,fee_reimb=fee_reimb,cat_admission=cat_admission)
            a.save()
        else:
            student_adm.objects.filter(uname=request.user.username).update(roll_no=roll_no,nationality=nationality,religion=religion,state=state,caste=caste,fee_reimb=fee_reimb,cat_admission=cat_admission)
        e=student_edu.objects.filter(uname=request.user.username).exists()
        if(e==False):
            e=student_edu(uname=request.user.username,roll_no=roll_no,sec_per=sec_per,sec_grade=sec_grade,sec_scl=sec_scl,inter_per=inter_per,inter_grade=inter_grade,inter_scl=inter_scl,eamcet_htno=eamcet_htno,eamcet_rank=eamcet_rank,eamcet_yr=eamcet_yr,jee_htno=jee_htno,jee_rank=jee_rank,jee_yr=jee_yr,ecet_htno=ecet_htno,ecet_rank=ecet_rank,ecet_yr=ecet_yr)
            e.save()
        else:
            student_edu.objects.filter(uname=request.user.username).update(roll_no=roll_no,sec_per=sec_per,sec_grade=sec_grade,sec_scl=sec_scl,inter_per=inter_per,inter_grade=inter_grade,inter_scl=inter_scl)
        p=student_profile.objects.filter(uname=request.user.username).exists()
        if(p==False):
            p=student_profile(uname=request.user.username,roll_no=roll_no,name=name,branch=branch,section=section,DOB=DOB,aadhar=aadhar,mobile=mobile,email=email)
            p.save()
        else:
            student_profile.objects.filter(uname=request.user.username).update(roll_no=roll_no,name=name,branch=branch,section=section,DOB=DOB,aadhar=aadhar,mobile=mobile,email=email)
        return render(request,'counselling/fill.html')
    e=student_edu.objects.get(uname=request.user.username)
    p1=student_profile.objects.get(uname=request.user.username)
    pa=student_parent.objects.get(uname=request.user.username)
    a=student_adm.objects.get(uname=request.user.username)
    s=student_stay.objects.get(uname=request.user.username)
    e=student_extra.objects.get(uname=request.user.username)
    return render(request,'counselling/profile.html',{"p1":p1,"e":e,"a":a,"pa":pa,"s":s,"e":e})


def basic_details(request):
    fac=MyUser.objects.filter(is_faculty=True)
    if request.method=="POST":
        hd=request.POST["hd"]
        hname=request.POST.get('hname',False)
        hph_no=request.POST.get("hph_no",False)
        wname=request.POST.get("wname",False)
        wph_no=request.POST.get("wph_no",False)
        haddress=request.POST.get("haddress",False)
        roommate1=request.POST.get("roommate1",False)
        roommate2=request.POST.get("roommate2",False)
        roommate3=request.POST.get("roommate3",False)
        w4=request.POST.get("w4",False)    
        w8=request.POST.get("8w",False)
        w12=request.POST.get("12w",False) 
        w16=request.POST.get("16w",False)
        final=request.POST.get("final",False)
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='basic_'+year+'_'+semester
        model = apps.get_model('student', x)
        b2=model.objects.filter(uname=request.user.username).exists()
        if(b2==False):
            cstatus_3_1.objects.filter(uname=request.user.username).update(counsellor_name=cname)
            b=model(uname=request.user.username,counsellor_name=cname,present_cname=cname,year=year,semester=semester,stay=hd,h_name=hname,h_phno=hph_no,w_name=wname,w_phno=wph_no,h_address=haddress,r1=roommate1,r2=roommate2,r3=roommate3,att4=w4,att8=w8,att12=w12,att16=w16,attf=final)
            b.save()
        else:
            b3=model.objects.get(uname=request.user.username)
            hd=request.POST["hd"]
            hname=request.POST.get('hname',b3.h_name)
            hph_no=request.POST.get("hph_no",b3.h_phno)
            wname=request.POST.get("wname",b3.w_name)
            wph_no=request.POST.get("wph_no",b3.w_phno)
            haddress=request.POST.get("haddress",b3.h_address)
            roommate1=request.POST.get("roommate1",b3.r1)
            roommate2=request.POST.get("roommate2",b3.r2)
            roommate3=request.POST.get("roommate3",b3.r3)
            w4=request.POST.get("w4",b3.att4)
            w8=request.POST.get("8w",b3.att8)
            w12=request.POST.get("12w",b3.att12)
            w16=request.POST.get("16w",b3.att16)
            final=request.POST.get("final",b3.attf)
            model.objects.filter(uname=request.user.username).update(stay=hd,h_name=hname,h_phno=hph_no,w_name=wname,w_phno=wph_no,h_address=haddress,r1=roommate1,r2=roommate2,r3=roommate3,att4=w4,att8=w8,att12=w12,att16=w16,attf=final)
        return render(request,'counselling/fill.html')
    else:
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='basic_'+year+'_'+semester
        model = apps.get_model('student', x)
        b=model.objects.get(uname=request.user.username)
        return render(request,'counselling/basic_details.html',{'b':b,'fac':fac})


def mid1(request):
    if request.method=="POST":
        theory1=request.POST.get("theory1",'')
        quiz1=request.POST.get("quiz1",'')
        assignment1=request.POST.get("assignment1",'')
        theory2=request.POST.get("theory2",'')
        quiz2=request.POST.get("quiz2",'')
        assignment2=request.POST.get("assignment2",'')
        theory3=request.POST.get("theory3",'')
        quiz3=request.POST.get("quiz3",'')
        assignment3=request.POST.get("assignment3",'')
        theory4=request.POST.get("theory4",'')
        quiz4=request.POST.get("quiz4",'')
        assignment4=request.POST.get("assignment4",'')
        theory5=request.POST.get("theory5",'')
        quiz5=request.POST.get("quiz5",'')
        assignment5=request.POST.get("assignment5",'')
        theory6=request.POST.get("theory6",'')
        quiz6=request.POST.get("quiz6",'')
        assignment6=request.POST.get("assignment6",'')
        theory7=request.POST.get("theory7",'')
        quiz7=request.POST.get("quiz7",'')
        assignment7=request.POST.get("assignment7",'')
        theory8=request.POST.get("theory8",'')
        quiz8=request.POST.get("quiz8",'')
        assignment8=request.POST.get("assignment8",'')
        theory9=request.POST.get("theory9",'')
        quiz9=request.POST.get("quiz9",'')
        assignment9=request.POST.get("assignment9",'')
        theory10=request.POST.get("theory10",'')
        quiz10=request.POST.get("quiz10",'')
        assignment10=request.POST.get("assignment10",'')
        s1_name=request.POST.get("s1_name",'')
        s2_name=request.POST.get("s2_name",'')
        s3_name=request.POST.get("s3_name",'')
        s4_name=request.POST.get("s4_name",'')
        s5_name=request.POST.get("s5_name",'')
        s6_name=request.POST.get("s6_name",'')
        s7_name=request.POST.get("s7_name",'')
        s8_name=request.POST.get("s8_name",'')
        s9_name=request.POST.get("s9_name",'')
        s10_name=request.POST.get("s10_name",'')
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='mid1_'+year+'_'+semester
        model = apps.get_model('student', x)
        b2=model.objects.filter(uname=request.user.username).exists()
        if(b2==False):
            b=model(uname=request.user.username,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name,s1_t=theory1,s1_q=quiz1,s1_ass=assignment1,s2_t=theory2,s2_q=quiz2,s2_ass=assignment2,s3_t=theory3,s3_q=quiz3,s3_ass=assignment3,s4_t=theory4,s4_q=quiz4,s4_ass=assignment4,s5_t=theory5,s5_q=quiz5,s5_ass=assignment5,s6_t=theory6,s6_q=quiz6,s6_ass=assignment6,s7_t=theory7,s7_q=quiz7,s7_ass=assignment7,s8_t=theory8,s8_q=quiz8,s8_ass=assignment8,s9_t=theory9,s9_q=quiz9,s9_ass=assignment9,s10_t=theory10,s10_q=quiz10,s10_ass=assignment10)
            b.save()
        else:
            b1=model.objects.get(uname=request.user.username)
            theory1=request.POST.get("theory1",b1.s1_t)
            quiz1=request.POST.get("quiz1",b1.s1_q)
            assignment1=request.POST.get("assignment1",b1.s1_ass)
            theory2=request.POST.get("theory2",b1.s2_t)
            quiz2=request.POST.get("quiz2",b1.s2_q)
            assignment2=request.POST.get("assignment2",b1.s2_ass)
            theory3=request.POST.get("theory3",b1.s3_t)
            quiz3=request.POST.get("quiz3",b1.s3_q)
            assignment3=request.POST.get("assignment3",b1.s3_ass)
            theory4=request.POST.get("theory4",b1.s4_t)
            quiz4=request.POST.get("quiz4",b1.s4_q)
            assignment4=request.POST.get("assignment4",b1.s4_ass)
            theory5=request.POST.get("theory5",b1.s5_t)
            quiz5=request.POST.get("quiz5",b1.s5_q)
            assignment5=request.POST.get("assignment5",b1.s5_ass)
            theory6=request.POST.get("theory6",b1.s6_t)
            quiz6=request.POST.get("quiz6",b1.s6_q)
            assignment6=request.POST.get("assignment6",b1.s6_ass)
            theory7=request.POST.get("theory7",b1.s7_t)
            quiz7=request.POST.get("quiz7",b1.s7_q)
            assignment7=request.POST.get("assignment7",b1.s7_ass)
            theory8=request.POST.get("theory8",b1.s8_t)
            quiz8=request.POST.get("quiz8",b1.s8_q)
            assignment8=request.POST.get("assignment8",b1.s8_ass)
            theory9=request.POST.get("theory9",b1.s9_t)
            quiz9=request.POST.get("quiz9",b1.s9_q)
            assignment9=request.POST.get("assignment9",b1.s9_ass)
            theory10=request.POST.get("theory10",b1.s10_t)
            quiz10=request.POST.get("quiz10",b1.s10_q)
            assignment10=request.POST.get("assignment10",b1.s10_ass)
            s1_name=request.POST.get("s1_name",b1.s1_name)
            s2_name=request.POST.get("s2_name",b1.s2_name)
            s3_name=request.POST.get("s3_name",b1.s3_name)
            s4_name=request.POST.get("s4_name",b1.s4_name)
            s5_name=request.POST.get("s5_name",b1.s5_name)
            s6_name=request.POST.get("s6_name",b1.s6_name)
            s7_name=request.POST.get("s7_name",b1.s7_name)
            s8_name=request.POST.get("s8_name",b1.s8_name)
            s9_name=request.POST.get("s9_name",b1.s9_name)
            s10_name=request.POST.get("s10_name",b1.s10_name)
            model.objects.filter(uname=request.user.username).update(s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name,s1_t=theory1,s1_q=quiz1,s1_ass=assignment1,s2_t=theory2,s2_q=quiz2,s2_ass=assignment2,s3_t=theory3,s3_q=quiz3,s3_ass=assignment3,s4_t=theory4,s4_q=quiz4,s4_ass=assignment4,s5_t=theory5,s5_q=quiz5,s5_ass=assignment5,s6_t=theory6,s6_q=quiz6,s6_ass=assignment6,s7_t=theory7,s7_q=quiz7,s7_ass=assignment7,s8_t=theory8,s8_q=quiz8,s8_ass=assignment8,s9_t=theory9,s9_q=quiz9,s9_ass=assignment9,s10_t=theory10,s10_q=quiz10,s10_ass=assignment10)
        return render(request,'counselling/fill.html')
    else:
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='mid1_'+year+'_'+semester
        model = apps.get_model('student', x)
        m=model.objects.get(uname=request.user.username)
        return render(request,'counselling/mid1.html',{'m':m})

def mid2(request):
    if request.method=="POST":
        theory1=request.POST.get("theory1",'')
        quiz1=request.POST.get("quiz1",'')
        assignment1=request.POST.get("assignment1",'')
        theory2=request.POST.get("theory2",'')
        quiz2=request.POST.get("quiz2",'')
        assignment2=request.POST.get("assignment2",'')
        theory3=request.POST.get("theory3",'')
        quiz3=request.POST.get("quiz3",'')
        assignment3=request.POST.get("assignment3",'')
        theory4=request.POST.get("theory4",'')
        quiz4=request.POST.get("quiz4",'')
        assignment4=request.POST.get("assignment4",'')
        theory5=request.POST.get("theory5",'')
        quiz5=request.POST.get("quiz5",'')
        assignment5=request.POST.get("assignment5",'')
        theory6=request.POST.get("theory6",'')
        quiz6=request.POST.get("quiz6",'')
        assignment6=request.POST.get("assignment6",'')
        theory7=request.POST.get("theory7",'')
        quiz7=request.POST.get("quiz7",'')
        assignment7=request.POST.get("assignment7",'')
        theory8=request.POST.get("theory8",'')
        quiz8=request.POST.get("quiz8",'')
        assignment8=request.POST.get("assignment8",'')
        theory9=request.POST.get("theory9",'')
        quiz9=request.POST.get("quiz9",'')
        assignment9=request.POST.get("assignment9",'')
        theory10=request.POST.get("theory10",'')
        quiz10=request.POST.get("quiz10",'')
        assignment10=request.POST.get("assignment10",'')
        s1_name=request.POST.get("s1_name",'')
        s2_name=request.POST.get("s2_name",'')
        s3_name=request.POST.get("s3_name",'')
        s4_name=request.POST.get("s4_name",'')
        s5_name=request.POST.get("s5_name",'')
        s6_name=request.POST.get("s6_name",'')
        s7_name=request.POST.get("s7_name",'')
        s8_name=request.POST.get("s8_name",'')
        s9_name=request.POST.get("s9_name",'')
        s10_name=request.POST.get("s10_name",'')
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='mid2_'+year+'_'+semester
        model = apps.get_model('student', x)
        b2=model.objects.filter(uname=request.user.username).exists()
        if(b2==False):
            b=model(uname=request.user.username,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name,s1_t=theory1,s1_q=quiz1,s1_ass=assignment1,s2_t=theory2,s2_q=quiz2,s2_ass=assignment2,s3_t=theory3,s3_q=quiz3,s3_ass=assignment3,s4_t=theory4,s4_q=quiz4,s4_ass=assignment4,s5_t=theory5,s5_q=quiz5,s5_ass=assignment5,s6_t=theory6,s7_t=theory7,s8_t=theory8)
            b.save()
        else:
            b1=model.objects.get(uname=request.user.username)
            theory1=request.POST.get("theory1",b1.s1_t)
            quiz1=request.POST.get("quiz1",b1.s1_q)
            assignment1=request.POST.get("assignment1",b1.s1_ass)
            theory2=request.POST.get("theory2",b1.s2_t)
            quiz2=request.POST.get("quiz2",b1.s2_q)
            assignment2=request.POST.get("assignment2",b1.s2_ass)
            theory3=request.POST.get("theory3",b1.s3_t)
            quiz3=request.POST.get("quiz3",b1.s3_q)
            assignment3=request.POST.get("assignment3",b1.s3_ass)
            theory4=request.POST.get("theory4",b1.s4_t)
            quiz4=request.POST.get("quiz4",b1.s4_q)
            assignment4=request.POST.get("assignment4",b1.s4_ass)
            theory5=request.POST.get("theory5",b1.s5_t)
            quiz5=request.POST.get("quiz5",b1.s5_q)
            assignment5=request.POST.get("assignment5",b1.s5_ass)
            theory6=request.POST.get("theory6",b1.s6_t)
            quiz6=request.POST.get("quiz6",b1.s6_q)
            assignment6=request.POST.get("assignment6",b1.s6_ass)
            theory7=request.POST.get("theory7",b1.s7_t)
            quiz7=request.POST.get("quiz7",b1.s7_q)
            assignment7=request.POST.get("assignment7",b1.s7_ass)
            theory8=request.POST.get("theory8",b1.s8_t)
            quiz8=request.POST.get("quiz8",b1.s8_q)
            assignment8=request.POST.get("assignment8",b1.s8_ass)
            theory9=request.POST.get("theory9",b1.s9_t)
            quiz9=request.POST.get("quiz9",b1.s9_q)
            assignment9=request.POST.get("assignment9",b1.s9_ass)
            theory10=request.POST.get("theory10",b1.s10_t)
            quiz10=request.POST.get("quiz10",b1.s10_q)
            assignment10=request.POST.get("assignment10",b1.s10_ass)
            s1_name=request.POST.get("s1_name",b1.s1_name)
            s2_name=request.POST.get("s2_name",b1.s2_name)
            s3_name=request.POST.get("s3_name",b1.s3_name)
            s4_name=request.POST.get("s4_name",b1.s4_name)
            s5_name=request.POST.get("s5_name",b1.s5_name)
            s6_name=request.POST.get("s6_name",b1.s6_name)
            s7_name=request.POST.get("s7_name",b1.s7_name)
            s8_name=request.POST.get("s8_name",b1.s8_name)
            s9_name=request.POST.get("s9_name",b1.s9_name)
            s10_name=request.POST.get("s10_name",b1.s10_name)
            model.objects.filter(uname=request.user.username).update(s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name,s1_t=theory1,s1_q=quiz1,s1_ass=assignment1,s2_t=theory2,s2_q=quiz2,s2_ass=assignment2,s3_t=theory3,s3_q=quiz3,s3_ass=assignment3,s4_t=theory4,s4_q=quiz4,s4_ass=assignment4,s5_t=theory5,s5_q=quiz5,s5_ass=assignment5,s6_t=theory6,s7_t=theory7,s8_t=theory8)
        return render(request,'counselling/fill.html')
    else:
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='mid2_'+year+'_'+semester
        model = apps.get_model('student', x)
        m=model.objects.get(uname=request.user.username)
        return render(request,'counselling/mid2.html',{'m':m})
        
def external(request):
    if request.method=="POST":
        attempt=request.POST.get("attempt",'')
        e_theory1=request.POST.get("e_theory1",'')
        e_theory2=request.POST.get("e_theory2",'')
        e_theory3=request.POST.get("e_theory3",'')
        e_theory4=request.POST.get("e_theory4",'')
        e_theory5=request.POST.get("e_theory5",'')
        e_theory6=request.POST.get("e_theory6",'')
        e_theory7=request.POST.get("e_theory7",'')
        e_theory8=request.POST.get("e_theory8",'')
        e_theory9=request.POST.get("e_theory9",'')
        e_theory10=request.POST.get("e_theory10",'')
        s1_name=request.POST.get("s1_name",'')
        s2_name=request.POST.get("s2_name",'')
        s3_name=request.POST.get("s3_name",'')
        s4_name=request.POST.get("s4_name",'')
        s5_name=request.POST.get("s5_name",'')
        s6_name=request.POST.get("s6_name",'')
        s7_name=request.POST.get("s7_name",'')
        s8_name=request.POST.get("s8_name",'')
        s9_name=request.POST.get("s9_name",'')
        s10_name=request.POST.get("s10_name",'')
        cgpa=request.POST.get("cgpa",'')
        backlog=request.POST.get("backlog",'')
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='external_'+year+'_'+semester
        model = apps.get_model('student', x)
        b2=model.objects.filter(uname=request.user.username).exists()
        if(b2==False):
            b=model(uname=request.user.username,attempt=attempt,cgpa=cgpa,backlogs1=backlog,s1_g1=e_theory1,s2_g1=e_theory2,s3_g1=e_theory3,s4_g1=e_theory4,s5_g1=e_theory5,s6_g1=e_theory6,s7_g1=e_theory7,s8_g1=e_theory8,s9_g1=e_theory9,s10_g1=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
            b.save()
        else:
            if(attempt=='1'):
                b1=model.objects.get(uname=request.user.username)
                e_theory1=request.POST.get("e_theory1",b1.s1_g1)
                e_theory2=request.POST.get("e_theory2",b1.s2_g1)
                e_theory3=request.POST.get("e_theory3",b1.s3_g1)
                e_theory4=request.POST.get("e_theory4",b1.s4_g1)
                e_theory5=request.POST.get("e_theory5",b1.s5_g1)
                e_theory6=request.POST.get("e_theory6",b1.s6_g1)
                e_theory7=request.POST.get("e_theory7",b1.s7_g1)
                e_theory8=request.POST.get("e_theory8",b1.s8_g1)
                e_theory9=request.POST.get("e_theory9",b1.s9_g1)
                e_theory10=request.POST.get("e_theory10",b1.s10_g1)
                s1_name=request.POST.get("s1_name",b1.s1_name)
                s2_name=request.POST.get("s2_name",b1.s2_name)
                s3_name=request.POST.get("s3_name",b1.s3_name)
                s4_name=request.POST.get("s4_name",b1.s4_name)
                s5_name=request.POST.get("s5_name",b1.s5_name)
                s6_name=request.POST.get("s6_name",b1.s6_name)
                s7_name=request.POST.get("s7_name",b1.s7_name)
                s8_name=request.POST.get("s8_name",b1.s8_name)
                s9_name=request.POST.get("s9_name",b1.s9_name)
                s10_name=request.POST.get("s10_name",b1.s10_name)
                cgpa=request.POST.get("cgpa",b1.cgpa)
                backlog=request.POST.get("backlog",b1.backlogs1)            
                model.objects.filter(uname=request.user.username).update(attempt=attempt,cgpa=cgpa,backlogs1=backlog,s1_g1=e_theory1,s2_g1=e_theory2,s3_g1=e_theory3,s4_g1=e_theory4,s5_g1=e_theory5,s6_g1=e_theory6,s7_g1=e_theory7,s8_g1=e_theory8,s9_g1=e_theory9,s10_g1=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
            if(attempt=='2'):
                b1=model.objects.get(uname=request.user.username)
                e_theory1=request.POST.get("e_theory1",b1.s1_g2)
                e_theory2=request.POST.get("e_theory2",b1.s2_g2)
                e_theory3=request.POST.get("e_theory3",b1.s3_g2)
                e_theory4=request.POST.get("e_theory4",b1.s4_g2)
                e_theory5=request.POST.get("e_theory5",b1.s5_g2)
                e_theory6=request.POST.get("e_theory6",b1.s6_g2)
                e_theory7=request.POST.get("e_theory7",b1.s7_g2)
                e_theory8=request.POST.get("e_theory8",b1.s8_g2)
                e_theory9=request.POST.get("e_theory9",b1.s9_g2)
                e_theory10=request.POST.get("e_theory10",b1.s10_g2)
                s1_name=request.POST.get("s1_name",b1.s1_name)
                s2_name=request.POST.get("s2_name",b1.s2_name)
                s3_name=request.POST.get("s3_name",b1.s3_name)
                s4_name=request.POST.get("s4_name",b1.s4_name)
                s5_name=request.POST.get("s5_name",b1.s5_name)
                s6_name=request.POST.get("s6_name",b1.s6_name)
                s7_name=request.POST.get("s7_name",b1.s7_name)
                s8_name=request.POST.get("s8_name",b1.s8_name)
                s9_name=request.POST.get("s9_name",b1.s9_name)
                s10_name=request.POST.get("s10_name",b1.s10_name)
                cgpa=request.POST.get("cgpa",b1.cgpa)
                backlog=request.POST.get("backlog",b1.backlogs2)
                model.objects.filter(uname=request.user.username).update(attempt=attempt,cgpa=cgpa,backlogs2=backlog,s1_g2=e_theory1,s2_g2=e_theory2,s3_g2=e_theory3,s4_g2=e_theory4,s5_g2=e_theory5,s6_g2=e_theory6,s7_g2=e_theory7,s8_g2=e_theory8,s9_g2=e_theory9,s10_g2=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
            if(attempt=='3'):
                b1=model.objects.get(uname=request.user.username)
                e_theory1=request.POST.get("e_theory1",b1.s1_g3)
                e_theory2=request.POST.get("e_theory2",b1.s2_g3)
                e_theory3=request.POST.get("e_theory3",b1.s3_g3)
                e_theory4=request.POST.get("e_theory4",b1.s4_g3)
                e_theory5=request.POST.get("e_theory5",b1.s5_g3)
                e_theory6=request.POST.get("e_theory6",b1.s6_g3)
                e_theory7=request.POST.get("e_theory7",b1.s7_g3)
                e_theory8=request.POST.get("e_theory8",b1.s8_g3)
                e_theory9=request.POST.get("e_theory9",b1.s9_g3)
                e_theory10=request.POST.get("e_theory10",b1.s10_g3)
                s1_name=request.POST.get("s1_name",b1.s1_name)
                s2_name=request.POST.get("s2_name",b1.s2_name)
                s3_name=request.POST.get("s3_name",b1.s3_name)
                s4_name=request.POST.get("s4_name",b1.s4_name)
                s5_name=request.POST.get("s5_name",b1.s5_name)
                s6_name=request.POST.get("s6_name",b1.s6_name)
                s7_name=request.POST.get("s7_name",b1.s7_name)
                s8_name=request.POST.get("s8_name",b1.s8_name)
                s9_name=request.POST.get("s9_name",b1.s9_name)
                s10_name=request.POST.get("s10_name",b1.s10_name)
                cgpa=request.POST.get("cgpa",b1.cgpa)
                backlog=request.POST.get("backlog",b1.backlogs3)
                model.objects.filter(uname=request.user.username).update(attempt=attempt,cgpa=cgpa,backlogs3=backlog,s1_g3=e_theory1,s2_g3=e_theory2,s3_g3=e_theory3,s4_g3=e_theory4,s5_g3=e_theory5,s6_g3=e_theory6,s7_g3=e_theory7,s8_g3=e_theory8,s9_g3=e_theory9,s10_g3=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
            if(attempt=='4'):
                b1=model.objects.get(uname=request.user.username)
                e_theory1=request.POST.get("e_theory1",b1.s1_g4)
                e_theory2=request.POST.get("e_theory2",b1.s2_g4)
                e_theory3=request.POST.get("e_theory3",b1.s3_g4)
                e_theory4=request.POST.get("e_theory4",b1.s4_g4)
                e_theory5=request.POST.get("e_theory5",b1.s5_g4)
                e_theory6=request.POST.get("e_theory6",b1.s6_g4)
                e_theory7=request.POST.get("e_theory7",b1.s7_g4)
                e_theory8=request.POST.get("e_theory8",b1.s8_g4)
                e_theory9=request.POST.get("e_theory9",b1.s9_g4)
                e_theory10=request.POST.get("e_theory10",b1.s10_g4)
                s1_name=request.POST.get("s1_name",b1.s1_name)
                s2_name=request.POST.get("s2_name",b1.s2_name)
                s3_name=request.POST.get("s3_name",b1.s3_name)
                s4_name=request.POST.get("s4_name",b1.s4_name)
                s5_name=request.POST.get("s5_name",b1.s5_name)
                s6_name=request.POST.get("s6_name",b1.s6_name)
                s7_name=request.POST.get("s7_name",b1.s7_name)
                s8_name=request.POST.get("s8_name",b1.s8_name)
                s9_name=request.POST.get("s9_name",b1.s9_name)
                s10_name=request.POST.get("s10_name",b1.s10_name)
                cgpa=request.POST.get("cgpa",b1.cgpa)
                backlog=request.POST.get("backlog",b1.backlogs4)
                model.objects.filter(uname=request.user.username).update(attempt=attempt,cgpa=cgpa,backlogs4=backlog,s1_g4=e_theory1,s2_g4=e_theory2,s3_g4=e_theory3,s4_g4=e_theory4,s5_g4=e_theory5,s6_g4=e_theory6,s7_g4=e_theory7,s8_g4=e_theory8,s9_g4=e_theory9,s10_g4=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
            if(attempt=='5'):
                b1=model.objects.get(uname=request.user.username)
                e_theory1=request.POST.get("e_theory1",b1.s1_g5)
                e_theory2=request.POST.get("e_theory2",b1.s2_g5)
                e_theory3=request.POST.get("e_theory3",b1.s3_g5)
                e_theory4=request.POST.get("e_theory4",b1.s4_g5)
                e_theory5=request.POST.get("e_theory5",b1.s5_g5)
                e_theory6=request.POST.get("e_theory6",b1.s6_g5)
                e_theory7=request.POST.get("e_theory7",b1.s7_g5)
                e_theory8=request.POST.get("e_theory8",b1.s8_g5)
                e_theory9=request.POST.get("e_theory9",b1.s9_g5)
                e_theory10=request.POST.get("e_theory10",b1.s10_g5)
                s1_name=request.POST.get("s1_name",b1.s1_name)
                s2_name=request.POST.get("s2_name",b1.s2_name)
                s3_name=request.POST.get("s3_name",b1.s3_name)
                s4_name=request.POST.get("s4_name",b1.s4_name)
                s5_name=request.POST.get("s5_name",b1.s5_name)
                s6_name=request.POST.get("s6_name",b1.s6_name)
                s7_name=request.POST.get("s7_name",b1.s7_name)
                s8_name=request.POST.get("s8_name",b1.s8_name)
                s9_name=request.POST.get("s9_name",b1.s9_name)
                s10_name=request.POST.get("s10_name",b1.s10_name)
                cgpa=request.POST.get("cgpa",b1.cgpa)
                backlog=request.POST.get("backlog",b1.backlogs5)
                year=request.session.get('year')
                semester=request.session.get('semester')
                x='external_'+year+'_'+semester
                model = apps.get_model('student', x)
                model.objects.filter(uname=request.user.username).update(attempt=attempt,cgpa=cgpa,backlogs5=backlog,s1_g5=e_theory1,s2_g5=e_theory2,s3_g5=e_theory3,s4_g5=e_theory4,s5_g5=e_theory5,s6_g5=e_theory6,s7_g5=e_theory7,s8_g5=e_theory8,s9_g5=e_theory9,s10_g5=e_theory10,s1_name=s1_name,s2_name=s2_name,s3_name=s3_name,s4_name=s4_name,s5_name=s5_name,s6_name=s6_name,s7_name=s7_name,s8_name=s8_name,s9_name=s9_name,s10_name=s10_name)
        return render(request,'counselling/fill.html')
    else:
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='mid1_'+year+'_'+semester
        model1 = apps.get_model('student', x)
        e=model1.objects.get(uname=request.user.username)
        year=request.session.get('year')
        semester=request.session.get('semester')
        x='external_'+year+'_'+semester
        model = apps.get_model('student', x)
        ex=model.objects.get(uname=request.user.username)
        ex1=model_to_dict(ex)
        return render(request,'counselling/external.html',{'e':e,'ex':ex,'ex1':ex1})
